from substitute_decrypt import substitute_decrypt
from plausibility import plausibility
from bigrams import transition_matrix, get_bigrams
from mutate_key import mutate_key
import random
import math

#zasifrovany text
input = "EPREQRE_AKWDRNDUK_BRQXZ_WRBDRN_REQOEQROYBEDR_VEQIVZRZNYEINYRKW_BRUQREQEYXRME_WRBDRMYB_EDWRMQNDAVHRNDJYBEDRNDUK_BRM_N_RMQZQNHIVRE_AKWDRVOIYERYNVRTI_NYWRBDR_VEQIRJ_REQRNDHDW_ORI_HR_WDRAQNDUAQNUVRM_NRMQZQNHI_RO_RVXRBZ_RWDE_RIDANDODRXDROVRJDRKQHNDRMIDBRBDHOHDB_ER_REPRKQRNDUK_BR_TPRBDRE_ARHVBDZNDREI_MYWR_NYROVRNDIDANDBRHDHDUAVRZXHPERNDNYRE_ARXWDRBZDERNDX_KPNDRN_ROWQAPR_RWYHBEZQRBDRX_UKI_NYRJDNRJDBEDRMQUADJEDR_RHQXYJDEDRBDREQKQRMIQBYOREDRNDOVXDBRMIQRNDKQRVHDW_ERNYURE_ARJ_ROVRMQBWVRHQAEQI_RN_ZIKWR_VEQIRBE_IPRM_NRO_R_BYRNDIZQZQVRKQIDUAVRZREQORZDAVRXREQKQROVXDRQZBDORHQBE_ERX_M_WRMWYUR_WDRBN_HREQRUKZ_W_TQKVRMIDXYJDRBN_HRTVHDRJDBEDRKQVM_ERO_IDNAVRN_RAWYNDR_RZPME_Z_ERBDRUDOVRBDRZDRBAQWDRVUYW_RI_HQBEYRBE_IYRTQXDR_ERO_RBE_IPRM_NRJDBEDRI_HQBEYRBE_IYRMDANDRI_HQBEYRMQBOYZ_WRBDRZNYEINYRKW_BRTVHDRARBQTDREQRHYEDREYBANQVERBE_IPO_RIVA_O_R_RT_ERBDRUWQZDUDRT_ERBDRXDRYRQN_RTVHDRJDHNQVRMIUK_ERMIDHRKVUYUYOYRZQH_OYRJDXRNDQHZI_ENDRX_MW_ZVJYRUDWPRBZDERTVHDRZRKIVXDRZI_BEYERBZDRJDX_EDRQTQUYR_RBDME_EREQRJBDORJ_RVHDW_WRO_IDNAQREQRJBDORVHDW_WRJ_RMQBWDUKNYRUKUDBRQMI_ZHVRNDUK_ERX_KPNQVERUDWDRWYHBEZQR_VEQIRBDRX_OI_UYWRNDMEDJRBDRONDRUQRUKUYROPBWYBRXDRXRODRZVWDRBDRIQXM_H_JYRWYHBADRMDZNYNPRN_M_HIEROPBWYBRXDRJ_RJBDORUKEDWREPKWDRAQNUDREQRJDRMIQBEDRWQSYA_RVH_WQBEYRUQM_ARJ_ROQKVRHQRNYRX_B_KQZ_ERHDW_WRJBDORUQRJBDOROQKWRZ_IQZ_WRJBDORWYHYRZU_BREDNRFREQRJBDORTPWRU_BEDUNDRJ_RA_X_WRJBDORNDH_ZDJEDROWQAVORXTI_NDR_REI_BA_ZYNPRX_BE_ZEDREDNRQK_ZNPRABDGERBDRB_W_O_NHIPR_RE_ARZYBRJ_AREQRHQM_HWQRZBYUKNYRODWYREYBYURN_MIQBEQRBMI_ZNPUKRKQBMQH_IBAPUKR_RMQWYEYUAPUKRN_OYEDARMIQUREQRNDJHDRJ_RNDJBDORMQWYEYAR_NYRKQBMQH_IRJ_RJDRMIDUDRNDOQKVRMIDBZDHUQZ_ERUQRHDW_ERBZDERBDRBN_HRMIQM_HNDR_RMQEQMYR_WDR_BMQNRBDREQRBE_NDRXRQTDUNDRVXN_Z_NPUKRHVZQHVRMQWYEYUAPUKR_RKQBMQH_IBAPUKR_BMQNRBDREQRMIQZDHDRX_RMQOQUYRZDHPREDUKNYAPR_RZDIDJNDKQROYNDNYRBRZPN_WQXDNYORZDBADIDKQRWYHBADKQRHVOPBWVRX_HN_RAQBOYUA_RA_E_BEIQG_R_WDRJDNQORB_ODRBE_ENYROQUDNBADRKQBMQH_IBADR_RJYNDRHVZQHPRMIQEYREQOVRBDRNDH_RNYURHDW_ERZNYEINYRKW_BRUKZYWAVROWUDWR_RNDNYREYRWYHBEZ_RWYEQRMQUADJRNDRE_ARKQNDORZXHPERNDOVBYRZPKPNQVERUDWDRWYHBEZQROWQUYRMQEIDTVJYRJDNQORZYURTIDKVR_TPRODWYRAHDRTPHWDER_RAW_BERZ_JYUA_RQNYREIDT_ROYBEQRBQVZYBWPUKRMDZNYNRVHDW_JYRXDRBVUKDRXDODRB_ODRHWQVKDRNVHWDR_TPREDUKRTIDKVRTPWQRUQRNDJZYURIDANDODRXDRBDRN_REDUKRMIVXYUKRXDODRNDJ_UYRWYHDRVHIXYRNDR_RTVHQVRHDW_ERAQZPR_RJYNDRZDUYRMIQRB_W_O_NHIPROWQUYRMIDUDRNDOQKQVRB_OYRMI_UQZ_ERBRQKNDORZYBRWYHYREDHPRTVHQVRBWQVXYEROWQAVORTVHQVRAHPXREQRE_ARUKUDBRN_XZ_ERTVHQVRMIQBEDRMI_UQZ_ERZREQZ_IN_UKRJ_AQREDHRTVHQVROYERJDNQORJYNDRM_NPRAQNDUAQNUVRBDRBN_HR_NYRE_ARONQKQRNDXODNYR_RNDNYREYRWYHBEZ_RWYEQRMIQTQK_RNDUKRONDRUQRO_ORHDW_ERZXHPEREQRUKEDWYRWYHDRZBYUKNYRUKEDWYROYEROWQAPRUKEDWRJDRQTUKQHRMIVOPBWR_REDUKNYA_RUKEDWYRJDRBE_ENYUYRYRZQJDNBEYRM_NYRYROW_HPRMQZQNHI_REQRIYA_WROPRZBYUKNYRX_REQROVXDODRMIQBYOREDRJ_ARTPRONDRNDTPWQRWYHBEZ_RWYEQR_WDRNDJZYUROYRKQRTPWQRWYEQRAHPXRJBDORZYHDWRJ_ARBDRB_OQRBEVJRUQRBEVJRKINDRHQREDRX_KVTPRUWQZDARTPRAIYUDWRAHPXRBDRE_ARN_REQRAQVA_RIZ_WRTPR_RXZDH_WRQTDRIVUDRJ_AQRTPRZYHDWRZJYXHDERZW_ARN_RBM_ENQVRAQWDJREDHRVXRBDREQRNDH_RX_BE_ZYEROWQUYRBDRTVHQVRONQXYERH_WRTVHQVRH_WR_RH_WRHIQTYERBE_IDRMDZNYNPRJDNRBYRZXMQODNRJ_AREQRHQA_XQZ_WRCQWGRODPNDIERXDRWYHDROVBDJYRVHDW_EROYBEQROWQAVOR_REDMIZDRB_W_O_NHIYRXDRBEZQIYRBE_BENPRJDHNQENPR_RBEDJNQIQHPRBZDERMIQBYOREDRCQWGRODPNDIERCQWGRODPNDIERJDRYNEDWDAEV_WRN_BDWBRVXRNDUQRE_ARKIQXNDKQR_RZI_XDHNDKQR_RNDBOPBWNDKQR_TPREYORNDAEDIPRYNEDWDAEV_WRNDUKEDWRQTIQHYERBZDERNVRNDUKREQRTPERNDZYBRUQREDHRHDW_RO_IDNA_RO_IDNA_RE_RBYROPBWYORKI_JDRN_RZPBDKI_HDROVBYBRTPEREYBDRIDAWYRJYRHDHDUDARBMYRE_ARQN_RNDZYRUQR_RO_RKIQXNDRHWQVKQVRUKZYWYR_RUQRHDW_RNDZYORNDJBMYBRBDRMQAQVBYRHQB_KNQVERBMYUAQVRJ_XPA_RN_RBMYUAVRBZDKQRNQBVRE_ARZYHYBR_REPRTPBRNDUK_WRMIYJYERNDUQRJ_AQRNQZQVRMQEQMVRBZDE_R_WDRE_ARMIDBE_NRUQM_AROQKVRHDW_ERX_XI_APR_ERBDRBE_NDRUQRBDROVBYRBE_ER_ERO_JYRZDUYRBZVJRNDQHZI_ENPRMIVTDKRYREQRJDRUQBYRJ_AQRVEDUK_RXDREQRUQRBDRHDJDRN_MWNVJDRBZQVRNVENQBER_RBZVJRX_AQNRNDBWQRTPREPROWQAPRNDJ_ARX_BE_ZYERNDBWQRJDRJYUKRMIYWYBRONQKQROVBYRBDRMIQRNDRVHDW_EROYBEQRNDBWQRTPR_TPRNDJ_ARZPOIDWYREIDT_RTPRN_RNDROQKW_RMIYJYERNDJ_A_RNDOQURNDTQRHDSDNDI_UDRMIYWYBRW_UYNDRTI_UKVRUQM_ARO_RMQI_HRMIYIQH_RN_MI_ZQZ_ERUQRBYRWYHDRN_HIQTYWYRE_AREDHPR_NYREPRVXRNDZDIYBRXDRBYRB_OYRMQOQKQVRE_ARZYHYBRE_ARZYHYBRN_AQNDURTPBEDRUKEDWYRX_BDRBMQWDK_ERXDRZ_BRNDAHQRNDTQRNDUQRBM_BYRNDUQREYRIDANVRZYBRAHQRJDBEDREDHRAHPXRVXRJDRMDEYN_RDZIQMPRMQEQMDN_RHQH_Z_ROWQAVOREI_BA_ZYNPR_REQIMDH_R_RZIE_UAPRZYBRAHQRKQIDUNDRHNDORYRNQUYRMI_UVJDRZRW_TQI_EQIYUKR_TPRN_BDWRJDBEDRVUYNNDJBYRO_BYNPR_RW_EAPRN_RIQXODE_NYRBZDE_RZYBRAHQRMVJUVJDROWQAVORMDNYXDRZYBRAHQRGYN_NUVJDREDNKWDRAQNDURBZDE_REVRUDWQVRNQZQVRMQEQMVRZYORZBDUKNPREQZ_INPRZBDUKNPRT_NAPRZBDUKNPRBE_EPRE_ARZYHYBRAHPTPRTPWYRJDNQOROWQUYRMIQEYRWYHDORE_ARTPRBDRBN_HRH_WQRNDUQRHDW_ER_WDRWYHYRMIQEYRWYHDOREQRBDRUWQZDUDRNDH_RX_BE_ZYERMQUADJRWYHYRMIQEYRWYHDORNDUQRODRN_M_H_REIDT_RTPRN_AQNDUROQKWYRTPEROWQUYRMIQEYROWQAVOROWQUYRMIQEYROWQAVORJ_AREQROPBWYBRN_MIYAW_HRAHPXRJDREDUKRB_W_O_NHIVRMIYWYBRONQKQROQKWYRTPRBDRODXYRBDTQVRBDIZ_ERQRNDJ_APRXHYTDURMQTIDXYRQRNDJ_AQVRX_EQAVRUYRUQRMQEQORVXRTVHQVRBMQWVRTQJQZ_ERQRZDEBYR_RZDEBYRTIDKPRN_AQNDURTPROVBDWYRX_M_BYERQRBZDEQZDRTIDKPRNDROWQUYRMIQEYROWQAVORUQROPBWYBRNDTPW_RTPREQKWDRHDJYNN_RWQSYA_RT_RNDREQRNDJHDROWQUYRNDOQKQVRTQJQZ_ERMIQEYROWQAVOREQRTPRTPWQRMIQEYRMIYIQHDROWQUYRJBQVRMIDUDRJDHDNRIQHRWYHYRJBQVRE_APRJDHDNRIQHRUWQZDUDR_RZYHYBRNDZ_HYRJYOREQRJDHDNRIQHR_RQURQRZBDUKNQRTQJVJYRVXR_NYRNDRQROYBEQRAHDRTPRXYWYR_WDRQROQURQRMIDBEYXRQRZWYZRQRBW_ZVRQREIKPR_RZYORJ_RQURJDBEDRMIQURTPRYRB_W_O_NHIYRNDOQKWYRODXYRBDTQVRTQJQZ_EREIDT_RQRMIDBEYXRN_URTPREQRHDW_WYRMIQBYOREDRUQRTPRXREQKQRODWYRNYURWDH_REQRXDRTPRJDHNYRODWYRHQU_BNDRZYURTIDKVR_RZYUROQUYRNDXRHIVXYR_RMQRU_BDRTPRBDREQRX_BDRQTI_EYWQR_RMIQURTPRODWYROYERJDHNYRZYUROQUYRNDXRHIVXYRZXHPERZBYUKNYRJBQVRBEDJNYRZBYUKNYRJBQVROWQUYRZBYUKNYRO_JYRBEDJNQVRAQBEIVRJBQVRBEDJNDRQBAWYZYR_RBEDJNDRMIVODINYRMIQURTPRBDRODWYRN_ZX_JDOROQIHQZ_ERMIQBYOREDRZDRJODNVRUDKQRTPRBMQWVRTQJQZ_WYRJDNRJDRNDUKRQNQRBDRVXRNDUQRN_JHDRAQVADJRBDRJDHNYRTPHWYRN_RX_M_HNYORTIDKVR_RHIVXYRN_RZPUKQHNYORTVHQVRBDRMQEYI_EREIDT_RZDRJODNVRX_M_HVRMIQEYRZPUKQHVRE_HPRO_BRDZIQMBADRB_W_O_NHIPR_RE_ORHQWDR_GIYUADREQRTPRZREQORTPWRUDIER_TPRN_AQNDUREYRJDHNYRNDUKEDWYRTPERZYURNDXREYRHIVXYRNVRUQRMVJHQVRJYOREQRHQA_X_ERZDRJODNVRUYZYWYX_UDRDFM_NXDRNDTQRJ_RNDZYORUDKQRZXHPUAPRBDRN_JHQVRNDJ_ADRYHDQZDRNDTQRMQWYEYUADRHVZQHPRMIQRNDXROWQUYRJDHNQKQRTIDKVRTVHQVROVBDERMQHIDX_EROWQAPRXRHIVKDKQRTIDKVRB_W_O_NHIYRJBQVRUYZYWYXQZ_NYRJ_AQROPRUWQZDUDREYRNDTVHQVROYERNQVXYRQROQUDNBADRKQBMQH_IBADRMI_ZNYRAVWEVINYRNDTQRJ_ADR_ISVODNEPR_RO_JYRXTI_NDRNDX_MQODNRXDRJBQVRT_JDUNDRZPXTIQJDNYR_NQRO_JYRK_T_HDJRXTI_NYRE_ARZYHYBREQRTPRTPWQR_TPRBDRNDN_VUYWYRQHRWYHYRJ_ARBDRHDW_JYRHDJYNPRMQUADJRMQUADJRQA_OXYAR_VEQIRZPBAQUYWR_RX_U_WRMIDTYK_ERMQRMI_UQZNDRMI_ZH_REQRTPRZREQORTPWRUDIER_TPREQRNDHQZDHWYRJ_RVXREQRZYHYORBE_UYRMQHYZ_ERBDRN_RO_MVRBZDE_RKDISQERAHDRJDRNDJ_A_RO_M_RBZDE_RJ_RJYRZYHYORE_ARHQTIDRE_HPRO_BR_EW_NEYUAPRQUD_NRBDRBEIDHQXDONYOR_RBDZDINYOROQIDORE_HPRJDRDZIQM_REVEQR_ODIYA_RE_ARE_HPRJDRAQWDTA_RAVWEVIPR_ROQHDINYRUYZYWYX_UDRXHDRNDAHDRJDRMQEQMDN_RBE_I_R_EW_NEYBR_REDHRE_OROWQUYRMQNQIVJYR_EW_NEYHVRNQZQVRMI_ZDR_REVKWDRO_BREYUKPR_RYNHYUAPRQUD_NRBE_IPRE_JDONPRQIYDNERUWQZDUDRAQWDTA_RWYHBEZ_RJ_ARBDRIYA_RE_HPRNDAHDRN_RZPUKQHRQHR_GIYAPRJDRMQEQMDN_ROPEYUA_RWDOVIYDRE_HPRJDRBVO_EI_RQRAQVBDARN_RX_M_HRQHRNYRQBEIVZDARE_N_RO_B_RAQWDTA_ROWQAVR_NQR_RE_ORZW_HNDRAYNSRB_W_O_NHDIRHVUKQZNYRKW_Z_RB_W_O_NHIVRE_HPRJDBEDRXYJYRE_M_TQPBRA_MYE_N_RZ_NREQUK_RMVZQHNYREYUKQOQIBEYRMQWQHYZQUYROWQUYRMIQBEDRJDJYUKRQIYDNERZYBRE_RUDW_RQTW_BERBDREDHRJODNVJDRWDOVIYDRAHDXEQRE_RHIVK_RQTW_BERUYZYWYXQZ_N_RMQDZIQMBEDW_R_RX_ODIYA_NYXQZ_N_ROQHDINYR_REDUKNYUAPRZPBMDW_RJDR_EW_NEYBRE_OREDHPRJDRHYAE_EQIDORUKYDGRB_W_O_NHDIRZDWYAPRHQTPZ_EDWREDUKNYAR_RZQJ_ARUYNSYBUK_NROWQAVR_RTQIYEDWRMDZNYNRQKIQON_RQBQTNQBERUWQZDUDRMQBWPBRJDRQNRQMI_ZHVROWQARNDRUKYDGRB_W_O_NHDIRJDRUWQZDARJODNVJDRBDRZW_BENDR_NHID_BRBUKVWEXDR_RTPWRX_RBZDEQZDRZ_WAPRNDAHDRBYAQZ_EDWDORMIQEQRNVR_NQREQRVXRE_ARO_BRE_ARE_HPRJDR_EW_NEYBR_RWDOVIYDREQRIQXHDWDNYRO_RHVZQHPRXDODMYBNDR_HOYNYBEI_EYZNYRAVWEVINYR_RN_IQHNYRNDX_MQODNRN_RN_IQHNYRHVZQHPRWDOVIBEYRB_W_O_NHIYROWVZYRMYHSYNRDNSWYBKRAHDXEQR_EW_NEBEYRT_BYURDNSWYBKRNQRHQTIDRTDKDORHQTPRMIQNYA_JYR_EW_NEQZDRTPZ_WPORBVDXBAPORA_N_WDORHQRYNHYUADKQRQUD_NVRMIYIQXDNDRAW_BYUA_RUDBE_RN_RZPUKQHRBMI_ZNDRN_MIQEYREQOVRWDOVIBEYROWQUYRBDREW_UYRMIDBRA_MRHQTIDRN_HDJDRN_RX_M_HNYRTIDKRTPZ_WDR_GIYAPREZIHYREQEYXRXDRARWDOVIYYRM_EIYRUDW_R_GIYA_RMIYIQXDNDRKDBWQRJDRWDOVIYDRWDOVIVORMIPURBRUYX_APR_RMQHQTNDRODXYR_EW_NEPR_RWDOVIPRBDRMIQKWVTVJDRMIQM_BERNDHVZDIPR_RQHZDADKQRNDMI_EDWBEZYRNDMI_EDWBEZYRN_RXYZQER_RN_RBOIERUYWYRBE_Z_JYRBDRXRNYUKRN_IQHPR_NQR_EW_NEQZDRMQKIH_JYRWDOVIPR_RN_XPZ_JYRJDRBMYN_ZPOYRHYZQUKPRWDOVIYRM_ARG_N_EYUAPRNDN_ZYHYR_EW_NEBADROWQAPR_RZYHYRZRNYUKRYOMDIY_WYBEPRX_M_HNYRH_TWPR_RMQIVBQZ_EDWDRBE_IDKQRUYBEDKQRMVZQHNYKQROWQUEZYRUKYDGRB_W_O_NHDIRBDRHQO_K_RAQNUDBYRN_RTIDXYUKRWDOVIBAPUKRMIPRZRX_JOVRDFMQIEVR_RUYZYWYX_UDRZXNDBDNPRAODERAYNSRB_W_O_NHDIRTPERNDI_HROVBYRMQZQWYERJDREQEYXRODNDRQXTIQJDNRZRX_EQUDREYSIYHBADRNDH_WDAQRNDAHDJBYKQRT_SH_HVREQRMI_BANDRHQOQIQHYRWDOVIYRMIDM_HNQVR_EW_NEBAQVRAQNUDBYR_RX_TYJYRHZ_R_EW_NEBADRQGYUYIPRMIPRMIQRNDJ_AQVRN_UYQN_WNYRVI_XAVRN_BWDHADOREQKQRHQJHDRARZ_WUDRMIYIQXDNDR_NQRHQJHDRARBZDEQZDRZ_WUDROWQAVRMIQEYROWQAVORZDRJODNVRAVWEVIPR_RMI_Z_R_RZDRJODNVRMI_ZDKQROWQUEZYRZDRJODNVRN_IQHNYRBW_ZPR_RZDWYAQBEYRKDBWQRJDRTVHROPRNDTQRQNYRWDOVIQZDRQXTIQJDNYRO_W_JBAPOYRAIYBPR_RHPA_OYRJQSVRMQHIDXQVRTDXROYWQBEYR_EW_NEBADRZDEIDWUDRX_REQRMQAIQUYWDJBYRDZIQMBAPRZXHDW_NYR_EW_NEQZDRZMVBEYRHQRWDOVIBAPUKROQIYRUKDOYUADRJDHPR_RAVWEVIPRXKQVTNPUKRT_AEDIYYRBRE_AQZPORZ_WDUNPORVBMDUKDORXDRBDREYORX_OQIYRZBDUKNPRBZDEQZDRQUD_NPROQIDRJDRYNGYAQZ_NQRVODWDRZPMDBEQZ_NPORX_TDINYOROQIDOR_REQRJDRAQNDURUWQZDUDROWQUYRZPKPNQVRZBYUKNYRZBYUKNYRHQRMQBWDHNYKQRTVHDREQRZPOIDWPRIQHRVUKQZ_RBDRMQRNYUKRJDNQOREDNRBE_IPRQKNYNSDNBAPRQEYBAR_NHIY_BDRBUKDVUKXDIYR_RUQRWYHDRWYHDR_KRMI_ZH_RWYHDRNVREYRBDRX_UNQVRMQO_WVRZI_UDERXRKQIRN_RTIDKPREQKQRUQRXVBE_NDRXRMDZNYNR_WDRQUD_NRTVHDRJDBEDRHWQVKQRBOIHDERIQXAW_HDOROWQAVRMDZNYNPRX_BDRMQO_WVRMQIQBEQVRN_NQBDORIDAROQIDRAIQARX_RAIQADORVBEQVMYR_RZBDUKNQRTVHDRBAQIQRJ_AQRHIYZRZXNYANDRNQZ_RWDSDNH_RQRMQEQMDRBZDE_RAEDIQVRBDBW_WRTVKRX_RKIYUKPRWYHYRTVHQVRE_ADRXA_XAPRQRMQEQMDNPUKROPEYUAPUKRXDOYUKRAEDIDRMIPRTPWPRAQWDTAQVRWYHBADRAVWEVIPRTVHDRBDREIDT_RT_JYERQRJ_ADBYR_NSWYYRNDTQRGI_NUYYRNDTQRNDODUAVR_RMQEQORH_WRVXREQRNDZYO"

#text z knihy
book = "TY_TO_TAKHLE_NECHAS_OZVAL_SE_NA_TOMTO_MISTE_AUTORUV_VNITRNI_HLAS_CO_TOTIZ_PTAL_SE_PISATEL_PONEKUD_NEJISTE_NECHAS_PANA_POVONDRU_TAKHLE_UMRIT_INU_BRANIL_SE_AUTOR_JA_TO_NEDELAM_RAD_ALE_KONECKONCU_PAN_POVONDRA_MA_UZ_SVA_LETA_REKNEME_ZE_MU_JE_HODNE_PRES_SEDMDESAT_A_TY_HO_NECHAS_ABY_SE_TAK_DUSEVNE_TRAPIL_ANI_MU_NEREKNES_DEDECKU_VZDYT_NENI_TAK_ZLE_SVET_NEZAHYNE_NA_MLOKY_A_LIDSTVO_SE_ZACHRANI_JEN_JESTE_POCKEJTE_A_DOZIJETE_SE_TOHO_PROSIM_TE_NEMUZES_PRO_NEHO_UDELAT_NIC_TAK_JA_MU_POSLU_DOKTORA_NAVRHL_AUTOR_STARY_PAN_MA_ASI_NERVOVOU_HORECKU_V_TOM_VEKU_Z_TOHO_MUZE_OVSEM_DOSTAT_ZAPAL_PLIC_ALE_SNAD_TO_CHVALABOHU_PREZIJE_SNAD_BUDE_JESTE_HOUPAT_MARENKU_NA_KLINE_A_VYPTAVAT_SE_CEMU_SE_VE_SKOLE_UCILA_RADOSTI_STARI_BOZE_AT_MA_STARY_PAN_JESTE_RADOSTI_STARI_PEKNE_RADOSTI_POSMIVAL_SE_VNITRNI_HLAS_BUDE_K_SOBE_TO_DITE_TISKNOUT_STARYMA_RUKAMA_A_BAT_SE_CLOVECE_BAT_SE_ZE_I_ONA_BUDE_JEDNOU_PRCHAT_PRED_HUCICIMI_VODAMI_JEZ_NEODVRATNE_ZAPLAVUJI_CELY_SVET_BUDE_V_HRUZE_VRASTIT_SVE_JEZATE_OBOCI_A_SEPTAT_TO_JSEM_JA_UDELAL_MARENKO_TO_JSEM_UDELAL_JA_POSLECHNI_CHCES_OPRAVDU_NECHAT_ZAHYNOUT_CELE_LIDSTVO_AUTOR_SE_ZAMRACIL_NEPTEJ_SE_MNE_CO_CHCI_MYSLIS_ZE_Z_ME_VULE_SE_ROZPADAJI_LIDSKE_PEVNINY_NAPADRT_MYSLIS_ZE_JA_JSEM_CHTEL_TYHLE_KONCE_TO_JE_PROSTE_LOGIKA_UDALOSTI_COPAK_JA_MOHU_DO_NI_ZASAHOVAT_DELAL_JSEM_CO_JSEM_MOHL_VAROVAL_JSEM_LIDI_VCAS_TEN_X_TO_JSEM_BYL_CASTECNE_JA_KAZAL_JSEM_NEDAVEJTE_MLOKUM_ZBRANE_A_TRASKAVINY_ZASTAVTE_TEN_OHAVNY_KSEFT_SE_SALAMANDRY_A_TAK_VIS_JAK_TO_DOPADLO_VSICHNI_MELI_TISIC_NAPROSTO_SPRAVNYCH_HOSPODARSKYCH_A_POLITICKYCH_NAMITEK_PROC_TO_NEJDE_JA_NEJSEM_POLITIK_ANI_HOSPODAR_JA_JE_PRECE_NEMOHU_PRESVEDCOVAT_CO_DELAT_SVET_SE_SNAD_PROPADNE_A_POTOPI_ALE_ASPON_SE_TO_STANE_Z_OBECNE_UZNAVANYCH_DUVODU_POLITICKYCH_A_HOSPODARSKYCH_ASPON_SE_TO_PROVEDE_ZA_POMOCI_VEDY_TECHNIKY_A_VEREJNEHO_MINENI_S_VYNALOZENIM_VESKEREHO_LIDSKEHO_DUMYSLU_ZADNA_KOSMICKA_KATASTROFA_ALE_JENOM_SAME_STATNI_MOCENSKE_HOSPODARSKE_A_JINE_DUVODY_PROTI_TOMU_SE_NEDA_NIC_DELAT_VNITRNI_HLAS_CHVILKU_MLCEL_A_NENI_TI_LIDSTVA_LITO_POCKEJ_NE_TAK_HONEM_VZDYT_NEMUSI_VYHYNOUT_CELE_LIDSTVO_MLOCI_POTREBUJI_JENOM_VIC_BREHU_ABY_MELI_KDE_BYDLET_A_KLAST_VAJICKA_ONI_TREBA_MISTO_SOUVISLYCH_PEVNIN_UDELAJI_ZE_SUCHE_ZEME_SAME_DLOUHE_NUDLE_ABY_TECH_BREHU_BYLO_CO_NEJVIC_REKNEME_ZE_SE_NA_TECH_PRUZICH_ZEME_NEJACI_LIDE_UDRZI_NE_A_BUDOU_DELAT_KOVY_A_JINE_VECI_PRO_SALAMANDRY_MLOCI_PRECE_NEMOHOU_SAMI_PRACOVAT_S_OHNEM_VIS_LIDI_TEDY_BUDOU_SLOUZIT_MLOKUM_BUDOU_KDYZ_TO_TAK_CHCES_NAZVAT_BUDOU_PROSTE_PRACOVAT_V_TOVARNACH_JAKO_TED_BUDOU_MIT_JENOM_JINE_PANY_KONECKONCU_SE_SNAD_ANI_TAK_MNOHO_NEZMENI_A_NENI_TI_LIDSTVA_LITO_PROBOHA_NECH_MNE_CO_MAM_DELAT_VZDYT_TO_CHTELI_LIDE_VSICHNI_CHTELI_MIT_MLOKY_CHTEL_JE_OBCHOD_PRUMYSL_A_TECHNIKA_CHTELI_JE_STATNICI_I_VOJENSTI_PANI_I_MLADY_POVONDRA_TO_RIKAL_MY_VSICHNI_ZA_TO_MUZEME_PROSIM_TE_JAK_BY_MNE_NEBYLO_LIDSTVA_LITO_ALE_NEJVIC_MI_HO_BYLO_LITO_KDYZ_JSEM_VIDEL_JAK_SE_SAMO_STUJ_CO_STUJ_HRNE_DO_TE_ZAHUBY_CLOVEK_BY_KRICEL_KDYZ_SE_TAK_NA_TO_KOUKA_RVAL_BY_A_ZVEDAL_OBE_RUCE_JAKO_BY_VIDEL_VJIZDET_VLAK_NA_SPATNOU_KOLEJ_TED_UZ_SE_TO_NEDA_ZASTAVIT_MLOCI_SE_BUDOU_MNOZIT_DAL_BUDOU_DAL_A_DAL_DROBIT_STARE_PEVNINY_JEN_SI_VZPOMEN_JAK_TO_DOKAZOVAL_WOLF_MEYNERT_ZE_LIDE_MUSEJI_UDELAT_MISTO_MLOKUM_A_TEPRVE_SALAMANDRI_ZE_STVORI_STASTNY_JEDNOTNY_A_STEJNORODY_SVET_PROSIM_TE_WOLF_MEYNERT_WOLF_MEYNERT_JE_INTELEKTUAL_NASELS_UZ_NECO_TAK_HROZNEHO_A_VRAZEDNEHO_A_NESMYSLNEHO_ABY_TIM_NEKTERY_INTELEKTUAL_NECHTEL_OBRODIT_SVET_NU_NECH_TO_BYT_NEVIS_CO_TED_DELA_MARENKA_MARENKA_TA_SI_MYSLIM_HRAJE_NA_VYSEHRADE_MUSIS_BYT_TISE_REKLI_JI_DEDECEK_SPI_TAK_ONA_NEVI_CO_A_MA_HROZNE_DLOUHOU_CHVILI_A_CO_DELA_NEVIM_NEJSPIS_SE_POKOUSI_DOSAHNOUT_SPICKOU_JAZYKA_NA_SPICKU_SVEHO_NOSU_TAK_VIDIS_A_TY_BYS_NECHAL_PRIJIT_NECO_JAKO_NOVOU_POTOPU_SVETA_ALE_TAK_PRESTAN_COPAK_MOHU_DELAT_ZAZRAKY_AT_SE_STANE_CO_SE_MUSI_STAT_AT_MAJI_VECI_SVUJ_NEODVRATNY_PRUBEH_I_TO_JE_COSI_JAKO_UTECHA_ZE_TO_CO_SE_DEJE_NAPLNUJE_SVOU_NUTNOST_A_SVUJ_ZAKON_NESLO_BY_TY_MLOKY_NEJAK_ZASTAVIT_NESLO_JE_JICH_PRILIS_MNOHO_MUSI_SE_PRO_NE_UDELAT_MISTO_NESLO_BY_ABY_NEJAK_VYMRELI_TREBA_BY_NA_NE_MOHLA_PRIJIT_NEJAKA_NEMOC_NEBO_DEGENERACE_PRILIS_LACINE_BRACHU_COPAK_MA_PORAD_PRIRODA_NAPRAVOVAT_CO_SI_LIDE_NADROBILI_TAK_TEDY_ANI_TY_UZ_NEVERIS_ZE_SI_SAMI_POMOHOU_TAK_VIDIS_TAK_VIDIS_NAKONEC_BYSTE_CHTELI_ZASE_SPOLEHAT_ZE_VAS_NEKDO_NEBO_NECO_SPASI_NECO_TI_REKNU_VIS_KDO_JESTE_TED_KDYZ_UZ_JE_PETINA_EVROPY_POTOPENA_DODAVA_MLOKUM_TRASKAVINY_A_TORPEDA_A_VRTACKY_VIS_KDO_HORECNE_DNEM_I_NOCI_PRACUJE_V_LABORATORICH_ABY_NASEL_JESTE_UCINNEJSI_MASINY_A_LATKY_NA_ROZMETANI_SVETA_VIS_KDO_PUJCUJE_MLOKUM_PENIZE_VIS_KDO_FINANCUJE_TENHLE_KONEC_SVETA_TU_CELOU_NOVOU_POTOPU_VIM_VSECHNY_TOVARNY_VSECHNY_BANKY_VSECHNY_STATY_TAK_VIDIS_KDYBY_BYLI_JENOM_MLOCI_PROTI_LIDEM_TAK_BY_SE_SNAD_DALO_NECO_DELAT_ALE_LIDI_PROTI_LIDEM_TO_SE_CLOVECE_NEDA_ZASTAVIT_POCKEJ_LIDI_PROTI_LIDEM_NECO_ME_NAPADA_TREBA_BY_NAKONEC_MOHLI_BYT_MLOCI_PROTI_MLOKUM_MLOCI_PROTI_MLOKUM_JAK_TO_MYSLIS_NAPRIKLAD_KDYZ_JE_TECH_SALAMANDRU_PRILIS_MNOHO_MOHLI_BY_SE_MEZI_SEBOU_SERVAT_O_NEJAKY_ZDIBEC_POBREZI_O_NEJAKOU_ZATOKU_CI_CO_POTOM_UZ_BUDOU_SPOLU_BOJOVAT_O_VETSI_A_VETSI_BREHY_NAKONEC_BY_MUSELI_ZAPASIT_O_SVETOVE_BREHY_NE_MLOCI_PROTI_MLOKUM_CO_MYSLIS_NEBYLA_BY_TOHLE_DEJINNA_LOGIKA_BA_NE_TO_NEJDE_MLOCI_NEMOHOU_BOJOVAT_PROTI_MLOKUM_TO_BY_BYLO_PROTI_PRIRODE_MLOCI_JSOU_PRECE_JEDEN_ROD_LIDI_JSOU_TAKY_JEDEN_ROD_CLOVECE_A_VIDIS_NEVADI_JIM_TO_JEDEN_ROD_A_OC_O_VSECHNO_BOJUJI_UZ_ANI_NE_O_MISTO_KDE_BY_ZILI_ALE_O_MOC_O_PRESTIZ_O_VLIV_O_SLAVU_O_TRHY_A_VIM_JA_OC_JESTE_PROC_BY_I_SALAMANDRI_NEMOHLI_MEZI_SEBOU_BOJOVAT_TREBA_O_PRESTIZ_NAC_BY_TO_DELALI_PROSIM_TE_CO_BY_Z_TOHO_MELI_NIC_LEDA_TO_ZE_BY_JEDNI_MELI_DOCASNE_VIC_BREHU_A_VIC_MOCI_NEZ_DRUZI_A_PO_CASE_BY_SE_TO_ZASE_OBRATILO_A_PROC_BY_MELI_MIT_JEDNI_VIC_MOCI_NEZ_DRUZI_VZDYT_VSICHNI_JSOU_STEJNI_VSICHNI_JSOU_MLOCI_VSICHNI_MAJI_STEJNOU_KOSTRU_JSOU_STEJNE_OSKLIVI_A_STEJNE_PRUMERNI_PROC_BY_SE_MELI_NAVZAJEM_MORDOVAT_PROSIM_TE_VE_JMENU_CEHO_BY_SPOLU_BOJOVALI_JEN_JE_NECH_ONO_SE_UZ_NECO_NAJDE_KOUKEJ_SE_JEDNI_BYDLI_NA_ZAPADNIM_BREHU_A_DRUZI_NA_VYCHODNIM_BUDOU_SE_POTIRAT_TREBA_VE_JMENU_ZAPADU_PROTI_VYCHODU_TADY_MAS_EVROPSKE_SALAMANDRY_A_TAM_DOLE_AFRICKE_TO_BY_V_TOM_BYL_CERT_ABY_NAKONEC_TI_JEDNI_NECHTELI_BYT_VIC_NEZ_TI_DRUZI_NU_CO_PUJDOU_JIM_TO_DOKAZAT_VE_JMENU_CIVILIZACE_EXPANZE_NEBO_JA_NEVIM_CEHO_VZDYCKY_SE_NAJDOU_NEJAKE_IDEOVE_NEBO_POLITICKE_DUVODY_PRO_NEZ_MLOCI_JEDNOHO_BREHU_BUDOU_MUSET_PODREZAT_MLOKY_Z_DRUHEHO_BREHU_SALAMANDRI_JSOU_CIVILIZOVANI_JAKO_MY_CLOVECE_TI_NEBUDOU_MIT_NOUZI_O_MOCENSKE_HOSPODARSKE_PRAVNI_KULTURNI_NEBO_JAKE_ARGUMENTY_A_MAJI_ZBRANE_NEZAPOMEN_ZE_JSOU_BAJECNE_VYZBROJENI_ANO_MAJI_HABADEJ_ZBRANI_TAK_VIDIS_TO_BY_BYLO_ABY_SE_NENAUCILI_OD_LIDI_JAK_SE_DELAJI_DEJINY_POCKEJ_POCKEJ_OKAMZIK_AUTOR_VYSKOCIL_A_ZACAL_PREBIHAT_PO_PRACOVNE_PRAVDA_TO_BY_V_TOM_BYL_CERT_ABY_TO_NEDOVEDLI_JA_UZ_TO_VIDIM_STACI_PODIVAT_SE_NA_MAPU_SVETA_HERGOT_KDE_JE_NEJAKA_MAPA_SVETA_JA_JI_VIDIM_TAK_DOBRE_TADY_MAS_ATLANTICKY_OCEAN_SE_STREDOZEMNIM_A_SEVERNIM_MOREM_TADY_JE_EVROPA_TUTO_AMERIKA_TAK_TADY_JE_KOLEBKA_KULTURY_A_MODERNI_CIVILIZACE_ZDE_NEKDE_JE_POTOPENA_STARA_ATLANTIS_A_TED_TAM_MLOCI_PONORUJI_ATLANTIDU_NOVOU_PRAVE_A_TUHLE_MAS_TICHY_A_INDICKY_OCEAN_STARY_TAJEMNY_ORIENT_CLOVECE_KOLEBKA_LIDSTVA_JAK_SE_RIKA_TADY_NEKDE_NA_VYCHOD_OD_AFRIKY_JE_POTOPENA_MYTICKA_LEMURIE_TADY_JE_SUMATRA_O_KOUSEK_NA_ZAPAD_OD_NI_OSTRUVEK_TANA_MASA_KOLEBKA_MLOKU_ANO_A_TAM_VLADNE_KING_SALAMANDER_DUCHOVNI_HLAVA_SALAMANDRU_TADY_JESTE_ZIJI_TAPABOYS_KAPITANA_VAN_TOCHA_PUVODNI_TICHOMORSTI_POLODIVOCI_MLOCI_PROSTE_JEJICH_ORIENT_VIS_TA_CELA_OBLAST_SE_TED_JMENUJE_LEMURIE_KDEZTO_TA_DRUHA_OBLAST_CIVILIZOVANA_POEVROPSTELA_A_ZAMERIKANIZOVANA_MODERNI_A_TECHNICKY_VYSPELA_JE_ATLANTIS_TAM_TEDY_JE_DIKTATOREM_CHIEF_SALAMANDER_VELIKY_DOBYVATEL_TECHNIK_A_VOJAK_CINGISCHAN_MLOKU_A_BORITEL_PEVNIN_OHROMNA_OSOBNOST_CLOVECE_POSLYS_JE_ON_OPRAVDU_MLOK_NE_CHIEF_SALAMANDER_JE_CLOVEK_JMENUJE_SE_VLASTNE_ANDREAS_SCHULTZE_A_BYL_ZA_SVETOVE_VALKY_NEKDE_SIKOVATELEM_PROTO_NU_ANO_TO_UZ_TAK_MAS_TAK_TADY_JE_ATLANTIS_A_LEMURIE_TO_ROZDELENI_MA_DUVODY_ZEMEPISNE_ADMINISTRATIVNI_KULTURNI_A_NARODNI_NEZAPOMEN_NA_NARODNI_DUVODY_LEMURSTI_SALAMANDRI_MLUVI_PIDGIN_ENGLISH_KDEZTO_ATLANTSTI_BASIC_ENGLISH_NO_DOBRE_BEHEM_DOBY_PRONIKAJI_ATLANTOVE_BYVALYM_SUEZSKYM_KANALEM_DO_INDICKEHO_OCEANU_PRIROZENE_KLASICKA_CESTA_NA_VYCHOD_SPRAVNE_NAPROTI_TOMU_LEMURSTI_MLOCI_SE_TLACI_PRES_KAP_DOBRE_NADEJE_NA_ZAPADNI_BREH_BYVALE_AFRIKY_TVRDI_TOTIZ_ZE_K_LEMURII_PATRI_CELA_AFRIKA_PRIROZENE_HESLO_JE_LEMURIE_LEMURUM_PRYC_S_CIZAKY_A_PODOBNE_MEZI_ATLANTY_A_LEMURY_SE_PROHLUBUJE_PROPAST_NEDUVERY_A_ODVEKEHO_NEPRATELSTVI_NEPRATELSTVI_NA_ZIVOT_A_NA_SMRT_CILI_STAVAJI_SE_Z_NICH_NARODY_ANO_ATLANTOVE_POHRDAJI_LEMURY_A_NAZYVAJI_JE_SPINAVYMI_DIVOCHY_LEMURI_PAK_FANATICKY_NENAVIDI_ATLANTSKE_MLOKY_A_VIDI_V_NICH_IMPERIALISTY_ZAPADNI_DABLY_A_PORUSOVATELE_STAREHO_CISTEHO_PUVODNIHO_MLOCTVI_CHIEF_SALAMANDER_SE_DOMAHA_KONCESI_NA_BREZICH_LEMURSKYCH_PRY_V_ZAJMU_EXPORTU_A_CIVILIZACE_VZNESENY_KMET_KING_SALAMANDER_BYT_NERAD_MUSI_POVOLIT_JE_TOTIZ_MENE_OZBROJEN_V_ZATOCE_TIGRIDSKE_NEDALEKO_NEKDEJSIHO_BAGDADU_TO_PRASKNE_DOMORODI_LEMURI_PREPADNOU_ATLANTSKOU_KONCESI_A_ZABIJI_DVA_ATLANTSKE_OFICIRY_PRY_PRO_NEJAKOU_NACIONALNI_URAZKU_NASLEDKEM_TOHO_DOJDE_K_VALCE_PRIROZENE_ANO_DOJDE_K_SVETOVE_VALCE_MLOKU_PROTI_MLOKUM_VE_JMENU_KULTURY_A_PRAVA_A_VE_JMENU_PRAVEHO_MLOCTVI_VE_JMENU_NARODNI_SLAVY_A_VELIKOSTI_HESLO_JE_BUD_MY_NEBO_ONI_LEMUROVE_OZBROJENI_MALAJSKYMI_KRISY_A_DYKAMI_JOGU_PODREZOU_BEZ_MILOSTI_ATLANTSKE_VETRELCE_ZA_TO_POKROCILEJSI_EVROPSKY_VZDELANI_ATLANTOVE_VPUSTI_DO_LEMURSKYCH_MORI_CHEMICKE_JEDY_A_KULTURY_ZHOUBNYCH_BAKTERII_S_TAKOVYM_VALECNYM_USPECHEM_ZE_SE_TIM_ZAMORI_VSECHNY_SVETOVE_OCEANY_MORE_JE_INFIKOVANO_UMELE_VYPESTOVANYM_ZABERNIM_MOREM_A_TO_JE_KONEC_CLOVECE_MLOCI_VYHYNOU_VSICHNI_VSICHNI_DO_POSLEDNIHO_BUDE_TO_VYMRELY_ROD_UCHOVA_SE_PO_NICH_JENOM_TEN_STARY_OHNINGENSKY_OTISK_ANDRIASE_SCHEUCHZERI_A_CO_LIDE_LIDE_AH_PRAVDA_LIDE_NU_TI_SE_ZACNOU_POMALU_VRACET_Z_HOR_NA_BREHY_TOHO_CO_ZUSTANE_Z_PEVNIN_ALE_OCEAN_BUDE_JESTE_DLOUHO_SMRDET_ROZKLADEM_MLOKU_PEVNINY_ZASE_POMALU_POROSTOU_NANOSEM_REK_MORE_KROK_ZA_KROKEM_USTOUPI_A_VSECHNO_BUDE_SKORO_JAKO_DRIV_VZNIKNE_NOVA_LEGENDA_O_POTOPE_SVETA_KTEROU_SESLAL_BUH_ZA_HRICHY_LIDI_BUDOU_TAKE_ZKAZKY_O_POTOPENYCH_MYTICKYCH_ZEMICH_KTERE_PRY_BYLY_KOLEBKOU_LIDSKE_KULTURY_BUDE_SE_TREBA_BAJIT_O_JAKESI_ANGLII_NEBO_FRANCII_NEBO_NEMECKU_A_POTOM_DAL_UZ_TO_NEVIM"

#abeceda pismen
alphabet = list("ABCDEFGHIJKLMNOPQRSTUVWXYZ_")

#bigramy nezasifrovaneho textu
bigrams = get_bigrams(book)

#matice nezasifrovaneho textu
matrix_ref = transition_matrix(bigrams, alphabet)

#nahodne vygenerovany pocatecni klic
start = random.sample(alphabet, 27)

#pocet iteraci algoritmu
iterations = 20000

def mh_algorithm(text, TM_ref, iter, start_key):
    current_key = start_key
    decrypted_current = substitute_decrypt(text, current_key)

    #verohodnost aktualniho klice
    p_current = plausibility(decrypted_current, TM_ref)
    
    for i in range(1, iter):
        #prohozeni dvou znaku
        candidate_key = mutate_key(current_key)
        decrypted_candidate = substitute_decrypt(text, candidate_key)
        
        #verohodnost kandidatniho klice
        p_candidate = plausibility(decrypted_candidate, TM_ref)

        #vypocet pravdepodobnosti prijeti noveho klice
        q = math.exp(p_candidate - p_current)

        #kriterium pro prijeti klice
        accept = False

        #klic prijmeme vzdy pokud je q > 1
        if q > 1:
            accept = True
        #nebo kdyz je nahodne cislo < 0.0005
        elif random.uniform(0, 1) < 0.0005:
            accept = True
        
        if accept:
            current_key = candidate_key
            p_current = p_candidate
        
        if i % 50 == 0:
            print(f"Iteration: {i}, Plausibility: {p_current}")
    
    best_decrypted_text = substitute_decrypt(text, current_key)
    return (f"Key: {''.join(current_key)}\nDecrypted text: {best_decrypted_text}")

print(mh_algorithm(input, matrix_ref, iterations, start))